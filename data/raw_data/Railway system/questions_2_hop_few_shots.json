[
    {
        "Category": "2-hop Node Level",
        "Question": "List the model and operator of all trains that operate on routes longer than 200 km and stop at stations with a capacity of over 1000.",
        "Cypher": "MATCH (train:Train)-[operates:OPERATES]->(route:Route)-[stops_at:STOPS_AT]->(station:Station)\nWHERE route.length > 200 AND station.capacity > 1000\nRETURN train, operates, route, stops_at, station, train.model, train.operator",
        "Schema-Validation": true,
        "Is-Corrected": false,
        "num-hop": 2,
        "Grammatical-Validation": true,
        "Rewrite": "Provide the model and operator of each train running on routes exceeding 200 km and halting at stations accommodating more than 1000 people."
    },
    {
        "Category": "2-hop Node Level",
        "Question": "Can you identify the names of cities where stations with more than 3 serving trains are located?",
        "Cypher": "MATCH (station:Station)-[serves:SERVES]->(city:City)<-[:LOCATED_IN]-(s:Station)<-[:OPERATES]-(train:Train)\nWITH station, serves, city, COUNT(train) AS TrainCount\nWHERE TrainCount > 3\nRETURN station, serves, city, city.name",
        "Schema-Validation": false,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (station:Station)-[serves:SERVES]->(city:City)<-[relation5:LOCATED_IN]-(s:Station)<-[relation6:OPERATES]-(train:Train)\nWITH station, serves, city, COUNT(train) AS TrainCount\nWHERE TrainCount > 3\nRETURN relation6, relation5, train, s, station, serves, city, city.name",
        "num-hop": 3,
        "Grammatical-Validation": false
    },
    {
        "Category": "2-hop Node Level",
        "Question": "Find the station names and their respective city names that have an employee named \"John Smith\" working on a role of 'Station Master'.",
        "Cypher": "MATCH (employee:Employee)-[employs:EMPLOYS]->(station:Station)-[located:LOCATED_IN]->(city:City)\nWHERE employee.name=\"John Smith\" AND employee.role=\"Station Master\"\nRETURN employee, employs, station, located, city, station.name, city.name",
        "Schema-Validation": true,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (employee:Employee)-[employs:EMPLOYS]-(station:Station)-[located:LOCATED_IN]->(city:City)\nWHERE employee.name=\"John Smith\" AND employee.role=\"Station Master\"\nRETURN employee, employs, station, located, city, station.name, city.name",
        "num-hop": 2,
        "Grammatical-Validation": true,
        "Rewrite": "Retrieve the names of stations along with the names of their corresponding cities where an employee called \"John Smith\" serves as a 'Station Master'."
    },
    {
        "Category": "2-hop Node Level",
        "Question": "Retrieve the names and capacity of all stations where 'Express Line' trains stop and which are situated in cities with a population greater than 1 million.",
        "Cypher": "MATCH (train:Train)-[operates:OPERATES]->(route:Route {name:\"Express Line\"})-[stopsAt:STOPS_AT]->(station:Station)-[locatedIn:LOCATED_IN]->(city:City)\nWHERE city.population > 1000000\nRETURN train, operates, route, stopsAt, station, locatedIn, city, station.name, station.capacity",
        "Schema-Validation": true,
        "Is-Corrected": false,
        "num-hop": 3,
        "Grammatical-Validation": true,
        "Rewrite": "Fetch the names and capacities of all stations served by 'Express Line' trains located in cities that have populations exceeding 1 million."
    },
    {
        "Category": "2-hop Node Level",
        "Question": "Display the model and capacity of trains that are operated by 'XYZ Corp' and travel on routes named 'Mountain Express'.",
        "Cypher": "MATCH (train:Train)-[operates:OPERATES]->(route:Route)\nWHERE train.operator=\"XYZ Corp\" AND route.name=\"Mountain Express\"\nRETURN train, operates, route, train.model, train.capacity",
        "Schema-Validation": true,
        "Is-Corrected": false,
        "Corrected-Cypher": "MATCH (train:Train)-[operates:OPERATES]->(route:Route), (train)-[:OPERATES]->(route {name:\"Mountain Express\"})\nWHERE train.operator = \"XYZ Corp\"\nRETURN relation3, train, operates, route, train.model, train.capacity",
        "num-hop": 1,
        "Grammatical-Validation": true,
        "Rewrite": "Show the model and capacity of trains operated by 'XYZ Corp' that run on routes called 'Mountain Express'."
    },
    {
        "Category": "2-hop Node Level",
        "Question": "Provide the names and the respective salaries of all employees who work at stations located within 10 km from the city center of 'New City'.",
        "Cypher": "MATCH (employee:Employee)-[employs:EMPLOYS]->(station:Station)-[serves:SERVES]->(city:City)\nWHERE city.name=\"New City\" AND serves.distance_to_city_center <= 10\nRETURN employee, employs, station, serves, city, employee.name, employee.salary",
        "Schema-Validation": true,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (employee:Employee)-[employs:EMPLOYS]-(station:Station)-[serves:SERVES]->(city:City)\nWHERE city.name=\"New City\" AND serves.distance_to_city_center <= 10\nRETURN employee, employs, station, serves, city, employee.name, employee.salary",
        "num-hop": 2,
        "Grammatical-Validation": true,
        "Rewrite": "List the names and corresponding salaries of all employees stationed within 10 km of the 'New City' center."
    },
    {
        "Category": "2-hop Relation Level",
        "Question": "What are the average arrival and departure delays for trains stopping at 'Central Station' that are part of the route 'Coastal Line'?",
        "Cypher": "MATCH (station:Station {name:\"Central Station\"})<-[stop:STOPS_AT]-(route:Route {name:\"Coastal Line\"})-[operate:OPERATES]->(train:Train)\nRETURN station, stop, route, operate, train, AVG(stop.arrival_delay), AVG(stop.departure_delay)",
        "Schema-Validation": true,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (station:Station {name:\"Central Station\"})<-[stop:STOPS_AT]-(route:Route {name:\"Coastal Line\"})-[operate:OPERATES]-(train:Train)\nRETURN station, stop, route, operate, train, AVG(stop.arrival_delay), AVG(stop.departure_delay)",
        "num-hop": 2,
        "Grammatical-Validation": true,
        "Rewrite": "What are the typical arrival and departure latencies for trains at 'Central Station' on the 'Coastal Line'?"
    },
    {
        "Category": "2-hop Relation Level",
        "Question": "How many stops are there between 'Downtown Station' and 'Uptown Station' on the route named 'City Circle'?",
        "Cypher": "MATCH (stationStart:Station {name:\"Downtown Station\"})-[:STOPS_AT]->(route:Route {name:\"City Circle\"})<-[:STOPS_AT]-(stationEnd:Station {name:\"Uptown Station\"})\nRETURN stationStart, route, stationEnd, COUNT(*) AS numberOfStops",
        "Schema-Validation": true,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (stationStart:Station {name:\"Downtown Station\"})-[relation3:STOPS_AT]-(route:Route {name:\"City Circle\"})-[relation4:STOPS_AT]-(stationEnd:Station {name:\"Uptown Station\"})\nRETURN relation4, relation3, stationStart, route, stationEnd, COUNT(*) AS numberOfStops",
        "num-hop": 2,
        "Grammatical-Validation": true,
        "Rewrite": "How many stations are there from 'Downtown Station' to 'Uptown Station' along the 'City Circle' route?"
    },
    {
        "Category": "2-hop Relation Level",
        "Question": "Can we find the longest distance to city center among stations served by the route 'Suburban Star'?",
        "Cypher": "MATCH (route:Route {name:\"Suburban Star\"})-[:OPERATES]->(train:Train), (route)-[stop:STOPS_AT]->(station:Station)-[serves:SERVES]->(city:City)\nRETURN route, train, stop, station, serves, city, MAX(serves.distance_to_city_center)",
        "Schema-Validation": true,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (route:Route {name:\"Suburban Star\"})-[relation4:OPERATES]-(train:Train), (route)-[stop:STOPS_AT]->(station:Station)-[serves:SERVES]->(city:City)\nRETURN relation4, route, train, stop, station, serves, city, MAX(serves.distance_to_city_center)",
        "num-hop": 3,
        "Grammatical-Validation": true,
        "Rewrite": "Is it possible to determine which station on the 'Suburban Star' route is the farthest from the city center?"
    },
    {
        "Category": "2-hop Relation Level",
        "Question": "What is the earliest departure time from the first stopping station on routes operated by the 'High-Speed 300' train?",
        "Cypher": "MATCH (train:Train {model:\"High-Speed 300\"})-[operates:OPERATES]->(route:Route)-[stopsAt:STOPS_AT]->(station:Station)\nWHERE stopsAt.stop_number=1\nRETURN train, operates, route, stopsAt, station, operates.departure_time",
        "Schema-Validation": true,
        "Is-Corrected": false,
        "num-hop": 2,
        "Grammatical-Validation": true,
        "Rewrite": "What is the earliest time the 'High-Speed 300' train departs from the initial station along its routes?"
    },
    {
        "Category": "2-hop Relation Level",
        "Question": "Determine the average employment duration for employees stationed at 'Gateway Terminal', who are also serving as 'Ticket Inspector'.",
        "Cypher": "MATCH (employee:Employee)-[employs:EMPLOYS]-(station:Station)\nWHERE station.name=\"Gateway Terminal\" AND employee.role=\"Ticket Inspector\"\nRETURN employee, employs, station, duration.inMonths(employs.employment_date, date()).months as employment_duration",
        "Schema-Validation": true,
        "Is-Corrected": false,
        "num-hop": 1,
        "Grammatical-Validation": true,
        "Rewrite": "Calculate the mean length of employment for workers assigned to 'Gateway Terminal' and holding the position of 'Ticket Inspector'."
    },
    {
        "Category": "2-hop Relation Level",
        "Question": "List all operational days for trains that have a stopping station within 5 km of 'Lake City' center.",
        "Cypher": "MATCH (station:Station)-[serves:SERVES]->(city:City)\nWHERE city.name=\"Lake City\" AND serves.distance_to_city_center <= 5\nMATCH (route:Route)-[stopsAt:STOPS_AT]->(station)\nMATCH (train:Train)-[operates:OPERATES]->(route)\nRETURN train, operates, route, stopsAt, station, serves, city, operates.operating_days",
        "Schema-Validation": true,
        "Is-Corrected": false,
        "num-hop": 3,
        "Grammatical-Validation": true,
        "Rewrite": "Provide a schedule of the days when trains operate that include a stop within 5 km of the center of 'Lake City'."
    },
    {
        "Category": "2-hop Statistical Level",
        "Question": "What is the average capacity of all trains that start and end their routes at stations with a capacity of less than 800?",
        "Cypher": "MATCH (startStation:Station)-[:STOPS_AT {stop_number: 1}]->(route:Route)<-[:OPERATES]-(train:Train),\n      (route)-[:STOPS_AT]->(endStation:Station)\nWHERE startStation.capacity < 800 AND endStation.capacity < 800 AND startStation.station_id = endStation.station_id\nRETURN AVG(train.capacity)",
        "Schema-Validation": true,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (startStation:Station)-[relation4:STOPS_AT {stop_number: 1}]-(route:Route)<-[relation5:OPERATES]-(train:Train),\n      (route)-[relation6:STOPS_AT]->(endStation:Station)\nWHERE startStation.capacity < 800 AND endStation.capacity < 800 AND startStation.station_id = endStation.station_id\nRETURN AVG(train.capacity)",
        "num-hop": 3,
        "Grammatical-Validation": true,
        "Rewrite": "What is the mean capacity of trains that begin and terminate their journeys at stations where the capacity is under 800?"
    },
    {
        "Category": "2-hop Statistical Level",
        "Question": "Compute the total number of employees working at stations located in cities with populations over 500,000.",
        "Cypher": "MATCH (station:Station)-[:LOCATED_IN]->(city:City)\nWHERE city.population > 500000\nMATCH (station)-[:EMPLOYS]->(employee:Employee)\nRETURN COUNT(DISTINCT employee) AS total_employees",
        "Schema-Validation": true,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (station:Station)-[relation3:LOCATED_IN]->(city:City)\nWHERE city.population > 500000\nMATCH (station)-[relation4:EMPLOYS]->(employee:Employee)\nRETURN COUNT(DISTINCT employee) AS total_employees",
        "num-hop": 2,
        "Grammatical-Validation": true,
        "Rewrite": "Calculate the total count of employees at stations situated in cities where the population exceeds 500,000."
    },
    {
        "Category": "2-hop Statistical Level",
        "Question": "Can you compute the average distance to the city center for each station on the route 'Valley Explorer'?",
        "Cypher": "MATCH (route:Route {name: \"Valley Explorer\"})-[stop:STOPS_AT]->(station:Station)-[serves:SERVES]->(city:City)\nRETURN station.name AS StationName, AVG(serves.distance_to_city_center) AS AvgDistanceToCityCenter",
        "Schema-Validation": true,
        "Is-Corrected": false,
        "num-hop": 2,
        "Grammatical-Validation": true,
        "Rewrite": "Could you calculate the mean distance from the city center for every station along the 'Valley Explorer' route?"
    },
    {
        "Category": "2-hop Statistical Level",
        "Question": "What is the minimum and maximum capacity of routes that have at least two stops where trains have a capacity of more than 200 passengers?",
        "Cypher": "MATCH (train:Train)-[operates:OPERATES]->(route:Route)-[stops_at:STOPS_AT]->(station:Station)\nWHERE train.capacity > 200\nWITH route, COUNT(DISTINCT station) AS stops_count\nWHERE stops_count >= 2\nRETURN MIN(route.capacity) AS Min_Capacity, MAX(route.capacity) AS Max_Capacity",
        "Schema-Validation": false,
        "Is-Corrected": false,
        "num-hop": 2,
        "Grammatical-Validation": true
    },
    {
        "Category": "2-hop Statistical Level",
        "Question": "How many stations with a capacity of more than 500 are located in cities that operate more than five different train models?",
        "Cypher": "MATCH (station:Station)-[:LOCATED_IN]->(city:City)\nWHERE station.capacity > 500\nWITH city, COUNT(DISTINCT station) AS stationCount\nMATCH (city)<-[:LOCATED_IN]-(otherStation:Station)<-[:OPERATES]-(train:Train)\nWITH city, stationCount, COLLECT(DISTINCT train.model) AS models\nWHERE SIZE(models) > 5\nRETURN SUM(stationCount) AS totalStations",
        "Schema-Validation": false,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (station:Station)-[relation4:LOCATED_IN]->(city:City)\nWHERE station.capacity > 500\nWITH city, COUNT(DISTINCT station) AS stationCount\nMATCH (city)<-[relation5:LOCATED_IN]-(otherStation:Station)<-[relation6:OPERATES]-(train:Train)\nWITH city, stationCount, COLLECT(DISTINCT train.model) AS models\nWHERE SIZE(models) > 5\nRETURN SUM(stationCount) AS totalStations",
        "num-hop": 3,
        "Grammatical-Validation": true
    },
    {
        "Category": "2-hop Statistical Level",
        "Question": "Calculate the total population of cities having at least three stations operating more than two routes each.",
        "Cypher": "MATCH (city:City)<-[:LOCATED_IN]-(station:Station)-[:OPERATES]->(train:Train)-[:OPERATES]->(route:Route)\nWITH city, station, COUNT(DISTINCT route) AS routeCount\nWHERE routeCount > 2\nWITH city, COUNT(DISTINCT station) AS stationCount\nWHERE stationCount >= 3\nRETURN SUM(city.population) AS totalPopulation",
        "Schema-Validation": true,
        "Is-Corrected": true,
        "Corrected-Cypher": "MATCH (city:City)<-[relation4:LOCATED_IN]-(station:Station)-[relation5:OPERATES]->(train:Train)-[relation6:OPERATES]->(route:Route)\nWITH city, station, COUNT(DISTINCT route) AS routeCount\nWHERE routeCount > 2\nWITH city, COUNT(DISTINCT station) AS stationCount\nWHERE stationCount >= 3\nRETURN SUM(city.population) AS totalPopulation",
        "num-hop": 3,
        "Grammatical-Validation": true,
        "Rewrite": "Determine the combined population of cities where at least three stations each operate more than two routes."
    }
]